Требуется разработать программу, которая получает через cli флаг --file путь до файл со сделками, читает его построчно, строит свечи и на выходе создает файлы со свечами с определенным масштабом.


Техническое описание


Создаем пайплайн.

1 стадия в пайплайне: получает файл, читает его построчно, отправляет в стадию 2 прочтенную строку

2.1 стадия в пайплайне: обработка сделки, построение свечки с масштабом 5min, и если свеча закрыта или пришел признак об окончании файла то передача свечки на стадию 3

2.2 стадия в пайплайне: обработка сделки, построение свечки с масштабом 30min, и если свеча закрыта или пришел признак об окончании файла то передача свечки на стадию 3

2.3 стадия в пайплайне: обработка сделки, построение свечки с масштабом 240min, и если свеча закрыта или пришел признак об окончании файла то передача свечки на стадию 3

3 стадия в пайплайне: сохранение полученной свечки в файл сразу при получении


Запуск программы должен начинаться с запуска пайплайна, далее в входной канал первой стадии пайплайнапоступает сигнал о начале обработки, после завершения третьей стадии пайплайна(получен сигнал из второй стадии об окончании файла) основная программа должна завершить свою работу, получив сигнал от третьей стадии пайплайна


Время ожидания завершения пайплайна ограничено и равно 5s, если за 5s пайплайн не завершил работу, необходимо залогировать сообщение об ошибке и завершить работу программы


Входные данные

Формат строки в входящем файле: <тикер>,<цена>,<кол-во>,<timestamp в UTC с точностью до миллисекунды>Сделки во входном файле отсортированы по времени по возрастанию


INPUT

trades.csv


Выходные данные

3 файла с наименованием candles_5min.csv, candles_20min.csv, candles_240min.csv


В каждом файле должны быть записаны свечи в формате <тикер>,<ts(левая граница интервала)>,<цена открытия>,<максимальная цена на интервале>,<минимальная цена на интервале>, <цена закрытия>.


ts должен быть в формате RFC3339


OUTPUT

candles_5min.csv

candles_30min.csv

candles_240min.csv


Детализация

    время проведения торгов: начало в 10 утра каждого дня, торги завершаются в 3 часа ночи следующего дня
    сделки, осуществленные вне времени проведения торгов считаются недействительными, то есть их не учитываем при построении свечных аггрегатов
    в репозитории tfs-go-hwдолжна быть создана папка hw3, в которой должен быть файл main.goи файл .gitignore