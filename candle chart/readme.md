Цель: разработать алгоритм, предрассчитывающий по историческим данным свечной график (ohlc chart)


Вход: биржевые сделки в формате csv (тикер акции, цена одной акции, кол-во купленных акций, время исполнения сделки с точностью до миллисекунды в UTC)


Выход: данные для построения свечных графиков с масштабом 5 минут, 30 минут, 4 часа


Детализация:

    сделки в csv, поданные на вход, отсортированы по времени по возрастанию
    сделки в csv представлены по нескольким акциям, то есть могут встречаться несколько разных тикеров акций
    на выходе требуется получить данные, сгруппированные по масштабам, отсортированные по времени по возрастанию
    время проведения торгов: начало в 10 утра каждого дня, торги завершаются в 3 часа ночи следующего дня
    сделки, осуществленные вне времени проведения торгов считаются недействительными, то есть их не учитываем при построении свечных аггрегатов


Примечания:

    тикер - уникальный идентификатор ценной бумаги на бирже. Например: SBER, AAPL, AMZN
    японская свеча - вид интервального графика (более подробно можно ознакомиться по ссылке: https://ru.wikipedia.org/wiki/Японские_свечи)
    ohlc - аббревиатура, где o - цена открытия на заданном интервале, h - максимальная цена на заданном интервале, l - минимальная цена на заданном интервале, с - цена закрытия на заданном интервале
    пример визуального представления свечного графика в приложении Тинькофф Инвестиции: AMZN Масштаб 4 часа


INPUT

trades.csv


OUTPUT

candles_5min.csv

candles_30min.csv

candles_240min.csv