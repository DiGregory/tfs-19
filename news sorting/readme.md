Группировка новостей


В Ленте Тинькофф Инвестиций много новостей от разных провайдеров. Случается такое, что разные провайдеры пишут новости об одном и том же событии. Чтобы наши пользователи не читали однотипные новости, перед выдачей их нужно сгруппировать.

Пример того, как выглядит карточка сгруппированных новостей: company-news.jpg


Правило группировки

Считаем, что две новости можно сгруппировать, если у них совпадают тикеры и новости были опубликованы в один и тот же день по московскому времени.

Для определённости считаем, что сгруппированные новости имеют приоритет при выдаче перед обычными новостями при одинаковом времени публикации.


Входные данные

Через аргумент командной строки `--file` передаётся обязательное имя до json файла, который содержит массив объектов с полями:

    id - идентификатор новости, числовой, int64
    title - заголовок новости, строковый
    body - текст новости
    published_at - дата публикации новости
    provider - поставщик новости. Например, vc.ru
    tickers - массив тикеров, к которым относится новость. Тикер - это идентификатор акции. Например, AAPL, AMZN, TCS. Считаем, что тикер характеризует компанию, о которой написана новость. Например, AMZN --> Amazon.

Объекты во входном файле расположены в произвольном порядке, т.е. не отсортированы.


Выходные данные

Ваша программа должна создать файл `out.json` (имя должно быть именно такое), который содержит массив объектов ленты (Feed) с полями:

    type - тип контента. М.б. "news" или "company_news"
    payload - вложенный объект, содержащий полезную информацию.

Если type==news, то в payload лежит объект новости.

Если type==company_news, то в payload располагается объект с полями:

    items - массив новостей
    published_at - минимальное время публикации новости из массива items
    tickers - массив тикеров компаний, по которым сгруппированы новости

Объекты в выходном файле должны быть отсортированы по дате публикации.


Файлы

    news.json - входные данные
    expected.json - ожидаемые выходные данные


go run main.go -file="news.json"